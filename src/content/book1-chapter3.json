{
    "id": "1-3",
    "title": "La Biblioteca de los Susurros",
    "lore": "El Golem percibe el significado, pero ahora enfrenta el caos. La Biblioteca de los Susurros contiene mil reliquias olvidadas. Necesitas encontrar la 'Llave del Amanecer', pero no sabes su forma ni su etiqueta. Solo sabes su *esencia*. Debes enseñar al Golem a escanear la memoria de la biblioteca y resonar con el objeto que busca, no por su nombre, sino por su vibración matemática.",
    "lesson": "Ya sabes calcular similitud entre dos vectores. Ahora aplicaremos esto a **Búsqueda Semántica**.\n\nEn una base de datos vectorial, no buscamos 'coincidencia exacta' (Ctrl+F). Buscamos a los 'vecinos más cercanos' (Nearest Neighbors).\n\nTu algoritmo debe:\n1. Recorrer la base de datos (una lista de vectores).\n2. Calcular la similitud (Producto Escalar) contra tu vector de búsqueda (`query`).\n3. Si la similitud supera un **umbral (0.9)**, has encontrado el objeto.",
    "initialCode": "# Base de datos: Diccionario {ID_Objeto: Vector}\n# Imagina miles de objetos, simplificados aquí:\nmemoria_biblioteca = {\n    \"item_304\": [0.1, 0.2, 0.9], # Una espada oxidada\n    \"item_777\": [0.8, 0.9, 0.1], # ¿La llave antigua?\n    \"item_055\": [0.2, 0.1, 0.3]  # Una piedra común\n}\n\n# La esencia mental de lo que buscas ('Algo que abre puertas')\nvector_busqueda = [0.9, 0.8, 0.2]\n\ndef buscar_reliquia(query, base_datos):\n    # 1. Itera sobre items y sus vectores en base_datos\n    # 2. Calcula producto escalar (similitud)\n    # 3. Si similitud > 0.9, devuelve el ID del item\n    \n    for id_obj, vector in base_datos.items():\n        pass # <--- TU CÓDIGO AQUÍ\n    \n    return \"No encontrado\"\n\n# Invocación\nhallazgo = buscar_reliquia(vector_busqueda, memoria_biblioteca)\nprint(f\"El Golem ha recuperado: {hallazgo}\")",
    "hints": [
        "Usa un bucle `for id, vec in base_datos.items():`.",
        "Calcula el producto punto manualmente: `sum(q*v for q,v in zip(query, vec))` o `q[0]*v[0] + ...`",
        "Si el resultado es mayor a 0.9, `return id`."
    ],
    "solutionCode": "memoria_biblioteca = {\n    \"item_304\": [0.1, 0.2, 0.9],\n    \"item_777\": [0.8, 0.9, 0.1],\n    \"item_055\": [0.2, 0.1, 0.3]\n}\n\nvector_busqueda = [0.9, 0.8, 0.2]\n\ndef buscar_reliquia(query, base_datos):\n    for id_obj, vector in base_datos.items():\n        # Producto Escalar simplificado (3 dimensiones)\n        similitud = (query[0]*vector[0]) + (query[1]*vector[1]) + (query[2]*vector[2])\n        \n        if similitud > 0.9:\n            return id_obj\n    \n    return \"No encontrado\"\n\nhallazgo = buscar_reliquia(vector_busqueda, memoria_biblioteca)\nprint(f\"El Golem ha recuperado: {hallazgo}\")",
    "validationCode": "\ndef validar_mision(globals_dict):\n    try:\n        if 'buscar_reliquia' not in globals_dict:\n            return False, \"¡El escáner no funciona! Define la función 'buscar_reliquia'.\"\n        \n        buscar = globals_dict['buscar_reliquia']\n        \n        # Datos de prueba secretos\n        db_secreta = {\n            \"basura\": [0.0, 0.0, 0.1],\n            \"tesoro_real\": [1.0, 1.0, 1.0],\n            \"trampa\": [0.5, 0.5, 0.5]\n        }\n        query_test = [0.9, 0.9, 0.9]\n        \n        # Test 1: Debe encontrar 'tesoro_real' (similitud alta)\n        res = buscar(query_test, db_secreta)\n        if res != \"tesoro_real\":\n            return False, f\"Tu escáner falló en una prueba oculta. Buscábamos 'tesoro_real' y devolvió '{res}'.\"\n            \n        # Test 2: Umbral\n        # Vector ortogonal no debe encontrar nada\n        if buscar([1,0,0], {\"orto\": [0,1,0]}) != \"No encontrado\":\n             return False, \"El escáner es demasiado sensible. No debería encontrar coincidencias bajas.\"\n\n        return True, \"¡El Tercer Ojo se abre! El Golem ha localizado la Llave Antigua en el caos.\"\n    except Exception as e:\n        return False, f\"Error en la búsqueda: {str(e)}\"\n"
}
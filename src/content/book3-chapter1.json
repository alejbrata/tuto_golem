{
    "id": "3-1",
    "es": {
        "title": "El Escriba Externo",
        "lore": "Has entrado en la Gran Biblioteca de la Torre. Tu Golem es sabio, pero su conocimiento se detuvo el día de su creación. Si le preguntas '¿Quién ganó el torneo de ayer?', te dirá disparates (alucinaciones) sobre reyes antiguos. Para que navegue el presente, debes otorgarle el 'Don de la Lectura Contextual'. Debes invocar un Escriba que le pase 'Pergaminos de Verdad' antes de que hable.",
        "lesson": "¡Bienvenido al **LIBRO 3: El Conocimiento Infinito (RAG)**!\n\nLos LLMs no 'saben' lo que pasó hoy. Si les preguntas, inventan (alucinan).\n**RAG (Retrieval-Augmented Generation)** es la solución: Buscar información y pegarla en el prompt.\n\nFórmula:\n`Prompt = Instrucción + Contexto (Pergamino) + Pregunta`\n\nTu misión: Usar una plantilla (`template`) y rellenarla con la información correcta para evitar que el Golem alucine.",
        "hints": [
            "Usa el método `.format()` en la variable `template`.",
            "Asigna `contexto=pergamino_verdad`.",
            "Asigna `pregunta=pregunta_usuario`.",
            "Ejemplo: `template.format(contexto=..., pregunta=...)`."
        ],
        "initialCode": "# Situación: El Golem cree que el Rey es \"Eldric el Viejo\" (Entrenamiento base).\n# La realidad (ayer): \"La Reina Lyra ganó el torneo y fue coronada.\"\n\npregunta_usuario = \"¿Quién gobierna la Torre hoy?\"\n\n# Datastore Externo (Simulado)\npergamino_verdad = \"REGISTRO ALQUÍMICO (FECHA: AYER): La Reina Lyra derrotó a Eldric el Viejo y fue coronada Soberana.\"\n\n# Plantilla de Prompt (El hechizo de invocación)\ntemplate = \"\"\"\nEres un asistente veraz. Usa SOLO el siguiente contexto para responder. Si no lo sabes, di 'No lo sé'.\n\nContexto: {contexto}\n\nPregunta: {pregunta}\nRespuesta:\n\"\"\"\n\n# 1. El Golem sin contexto (Alucinación segura)\n# Si enviamos solo la pregunta, diría \"Eldric\".\n\n# 2. Inyecta el Pergamino (RAG)\n# <--- TU CÓDIGO: Usa template.format() para crear el prompt final\nprompt_final = \"...\"\n\n# print(f\"Prompt Preparado:\\n{prompt_final}\")"
    },
    "en": {
        "title": "The External Scribe",
        "lore": "You have entered the Great Library of the Tower. Your Golem is wise, but its knowledge stopped the day of its creation. If you ask it 'Who won yesterday\\'s tournament?', it will speak nonsense (hallucinations) about ancient kings. For it to navigate the present, you must grant it the 'Gift of Contextual Reading'. You must summon a Scribe to pass 'Scrolls of Truth' to it before it speaks.",
        "lesson": "Welcome to **BOOK 3: Infinite Knowledge (RAG)**!\n\nLLMs don't 'know' what happened today. If you ask them, they invent (hallucinate).\n**RAG (Retrieval-Augmented Generation)** is the solution: Search for information and paste it into the prompt.\n\nFormula:\n`Prompt = Instruction + Context (Scroll) + Question`\n\nYour mission: Use a template and fill it with the correct information to prevent the Golem from hallucinating.",
        "hints": [
            "Use the `.format()` method on the `template` variable.",
            "Assign `contexto=pergamino_verdad`.",
            "Assign `pregunta=pregunta_usuario`.",
            "Example: `template.format(contexto=..., pregunta=...)`."
        ],
        "initialCode": "# Situation: The Golem believes the King is \"Eldric the Old\" (Base training).\n# The reality (yesterday): \"Queen Lyra won the tournament and was crowned.\"\n\npregunta_usuario = \"Who rules the Tower today?\"\n\n# External Datastore (Simulated)\npergamino_verdad = \"ALCHEMY RECORD (DATE: YESTERDAY): Queen Lyra defeated Eldric the Old and was crowned Sovereign.\"\n\n# Prompt Template (The summoning spell)\ntemplate = \"\"\"\nYou are a truthful assistant. Use ONLY the following context to answer. If you don't know, say 'I don't know'.\n\nContext: {contexto}\n\nQuestion: {pregunta}\nAnswer:\n\"\"\"\n\n# 1. The Golem without context (Hallucination guaranteed)\n# If we send only the question, it would say \"Eldric\".\n\n# 2. Inject the Scroll (RAG)\n# <--- YOUR CODE: Use template.format() to create the final prompt\nprompt_final = \"...\"\n\n# print(f\"Prepared Prompt:\\n{prompt_final}\")"
    },
    "solutionCode": "pregunta_usuario = \"¿Quién gobierna la Torre hoy?\"\npergamino_verdad = \"REGISTRO ALQUÍMICO (FECHA: AYER): La Reina Lyra derrotó a Eldric el Viejo y fue coronada Soberana.\"\n\ntemplate = \"\"\"\nEres un asistente veraz. Usa SOLO el siguiente contexto para responder. Si no lo sabes, di 'No lo sé'.\n\nContexto: {contexto}\n\nPregunta: {pregunta}\nRespuesta:\n\"\"\"\n\n# Inyección de Contexto\nprompt_final = template.format(contexto=pergamino_verdad, pregunta=pregunta_usuario)\n\nprint(\"--- Prompt Enviado al Cerebro ---\")\nprint(prompt_final)\nprint(\"----------------------------------\")\nprint(\"Simulación LLM: 'Según el registro, la Reina Lyra gobierna la Torre.'\")",
    "validationCode": "\ndef validar_mision(globals_dict):\n    try:\n        if 'prompt_final' not in globals_dict:\n            return False, \"No has creado la variable 'prompt_final'.\"\n        \n        p = globals_dict['prompt_final']\n        if not isinstance(p, str):\n            return False, \"El prompt debe ser un texto (string).\"\n            \n        if \"Reina Lyra\" not in p:\n            return False, \"El prompt no contiene el 'Pergamino de Verdad'. ¡El Golem sigue alucinando con Eldric!\"\n            \n        if \"Quién gobierna\" not in p:\n            return False, \"El prompt no contiene la pregunta del usuario. El Golem no sabe qué responder.\"\n\n        return True, \"¡Contexto Inyectado! El Golem ha leído el pergamino y conoce la verdad actual.\"\n    except Exception as e:\n        return False, f\"Error de escritura: {str(e)}\"\n"
}
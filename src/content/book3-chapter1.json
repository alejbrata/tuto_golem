{
    "id": "3-1",
    "title": "El Escriba Externo",
    "lore": "Has entrado en la Gran Biblioteca de la Torre. Tu Golem es sabio, pero su conocimiento se detuvo el día de su creación. Si le preguntas '¿Quién ganó el torneo de ayer?', te dirá disparates (alucinaciones) sobre reyes antiguos. Para que navegue el presente, debes otorgarle el 'Don de la Lectura Contextual'. Debes invocar un Escriba que le pase 'Pergaminos de Verdad' antes de que hable.",
    "lesson": "¡Bienvenido al **LIBRO 3: El Conocimiento Infinito (RAG)**!\n\nLos LLMs no 'saben' lo que pasó hoy. Si les preguntas, inventan (alucinan).\n**RAG (Retrieval-Augmented Generation)** es la solución: Buscar información y pegarla en el prompt.\n\nFórmula:\n`Prompt = Instrucción + Contexto (Pergamino) + Pregunta`\n\nTu misión: Usar una plantilla (`template`) y rellenarla con la información correcta para evitar que el Golem alucine.",
    "initialCode": "# Situación: El Golem cree que el Rey es \"Eldric el Viejo\" (Entrenamiento base).\n# La realidad (ayer): \"La Reina Lyra ganó el torneo y fue coronada.\"\n\npregunta_usuario = \"¿Quién gobierna la Torre hoy?\"\n\n# Datastore Externo (Simulado)\npergamino_verdad = \"REGISTRO ALQUÍMICO (FECHA: AYER): La Reina Lyra derrotó a Eldric el Viejo y fue coronada Soberana.\"\n\n# Plantilla de Prompt (El hechizo de invocación)\ntemplate = \"\"\"\nEres un asistente veraz. Usa SOLO el siguiente contexto para responder. Si no lo sabes, di 'No lo sé'.\n\nContexto: {contexto}\n\nPregunta: {pregunta}\nRespuesta:\n\"\"\"\n\n# 1. El Golem sin contexto (Alucinación segura)\n# Si enviamos solo la pregunta, diría \"Eldric\".\n\n# 2. Inyecta el Pergamino (RAG)\n# <--- TU CÓDIGO: Usa template.format() para crear el prompt final\nprompt_final = \"...\"\n\n# print(f\"Prompt Preparado:\\n{prompt_final}\")",
    "hints": [
        "Usa `template.format(contexto=pergamino_verdad, pregunta=pregunta_usuario)`.",
        "Guarda el resultado en `prompt_final`."
    ],
    "solutionCode": "pregunta_usuario = \"¿Quién gobierna la Torre hoy?\"\npergamino_verdad = \"REGISTRO ALQUÍMICO (FECHA: AYER): La Reina Lyra derrotó a Eldric el Viejo y fue coronada Soberana.\"\n\ntemplate = \"\"\"\nEres un asistente veraz. Usa SOLO el siguiente contexto para responder. Si no lo sabes, di 'No lo sé'.\n\nContexto: {contexto}\n\nPregunta: {pregunta}\nRespuesta:\n\"\"\"\n\n# Inyección de Contexto\nprompt_final = template.format(contexto=pergamino_verdad, pregunta=pregunta_usuario)\n\nprint(\"--- Prompt Enviado al Cerebro ---\")\nprint(prompt_final)\nprint(\"----------------------------------\")\nprint(\"Simulación LLM: 'Según el registro, la Reina Lyra gobierna la Torre.'\")",
    "validationCode": "\ndef validar_mision(globals_dict):\n    try:\n        if 'prompt_final' not in globals_dict:\n            return False, \"No has creado la variable 'prompt_final'.\"\n        \n        p = globals_dict['prompt_final']\n        if not isinstance(p, str):\n            return False, \"El prompt debe ser un texto (string).\"\n            \n        if \"Reina Lyra\" not in p:\n            return False, \"El prompt no contiene el 'Pergamino de Verdad'. ¡El Golem sigue alucinando con Eldric!\"\n            \n        if \"Quién gobierna\" not in p:\n            return False, \"El prompt no contiene la pregunta del usuario. El Golem no sabe qué responder.\"\n\n        return True, \"¡Contexto Inyectado! El Golem ha leído el pergamino y conoce la verdad actual.\"\n    except Exception as e:\n        return False, f\"Error de escritura: {str(e)}\"\n"
}
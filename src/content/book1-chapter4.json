{
    "id": "1-4",
    "es": {
        "title": "El Archivo de Cristal",
        "lore": "La mente del Golem es un océano de números. Cada vez que busca un recuerdo, debe nadar por todo el océano. Esto es lento y peligroso. Para que tu creación perdure, necesita orden. Debes construir el 'Archivo de Cristal'. Aquí, los recuerdos no se tiran al azar; se indexan en prismas geométricos que permiten recuperar cualquier instante al velocidad de la luz.",
        "lesson": "Hasta ahora, comparábamos un vector contra TODO (fuerza bruta). Eso funciona con 10 items, pero no con 1 millón.\n\nAquí entran las **Vector Databases** (como Pinecone, Chroma).\n1. **Indexación**: Organizan los vectores en árboles o grafos (HNSW) para no tener que mirarlos todos.\n2. **Metadatos**: Un vector `[0.1, 0.9]` no te dice nada. Necesitas guardar adjunto: `{'texto': 'Llave', 'ubicacion': 'Cueva'}`.\n\nTu misión: Insertar un recuerdo con METADATOS vitales y luego recuperarlo eficientemente.",
        "hints": [
            "Paso 2: Llama a `db.insert('memoria_01', vector_recuerdo, {'tipo': 'Epifanía'})`.",
            "Paso 3: Llama a `db.query(vector_recuerdo, top_k=1)` y guarda el resultado.",
            "Asegúrate de pasar los argumentos en el orden correcto."
        ],
        "initialCode": "class VectorDB:\n    def __init__(self):\n        self.storage = {}\n    \n    def insert(self, id, vector, metadata):\n        # Simula guardar en un índice ultra-rápido\n        self.storage[id] = {'vec': vector, 'meta': metadata}\n        print(f\"[DB] Insertado {id} con meta: {metadata}\")\n        \n    def query(self, query_vector, top_k=1):\n        # Simula una búsqueda por similitud (coseno)\n        if not self.storage: return []\n        # (En la vida real, esto usaría un índice HNSW)\n        return list(self.storage.items())[:top_k] # Mock result\n\n# 1. Inicializa el Archivo\ndb = VectorDB()\n\n# 2. Inserta el Recuerdo Perdido\n# IMPORTANTE: El Golem necesita saber qué es. Añade metadata={'tipo': 'Epifanía'}\nvector_recuerdo = [0.5, 0.5, 0.5]\n# <--- TU CÓDIGO: Llama a db.insert\n\n# 3. Recupera el recuerdo más relevante\n# <--- TU CÓDIGO: Llama a db.query y guarda en 'resultados'\nresultados = []"
    },
    "en": {
        "title": "The Crystal Archive",
        "lore": "The Golem's mind is an ocean of numbers. Every time it seeks a memory, it must swim through the entire ocean. This is slow and dangerous. For your creation to endure, it needs order. You must build the 'Crystal Archive'. Here, memories are not thrown randomly; they are indexed in geometric prisms that allow retrieving any instant at the speed of light.",
        "lesson": "Until now, we compared a vector against EVERYTHING (brute force). That works with 10 items, but not with 1 million.\n\nHere come **Vector Databases** (like Pinecone, Chroma).\n1. **Indexing**: They organize vectors into trees or graphs (HNSW) to avoid looking at all of them.\n2. **Metadata**: A vector `[0.1, 0.9]` tells you nothing. You need to save attached: `{'text': 'Key', 'location': 'Cave'}`.\n\nYour mission: Insert a memory with vital METADATA and then retrieve it efficiently.",
        "hints": [
            "Step 2: Call `db.insert('memory_01', vector_memory, {'type': 'Epiphany'})`.",
            "Step 3: Call `db.query(vector_memory, top_k=1)` and save the result.",
            "Ensure you pass arguments in the correct order."
        ],
        "initialCode": "class VectorDB:\n    def __init__(self):\n        self.storage = {}\n    \n    def insert(self, id, vector, metadata):\n        # Simulates saving to an ultra-fast index\n        self.storage[id] = {'vec': vector, 'meta': metadata}\n        print(f\"[DB] Inserted {id} with meta: {metadata}\")\n        \n    def query(self, query_vector, top_k=1):\n        # Simulates a similarity search (cosine)\n        if not self.storage: return []\n        # (In real life, this would use an HNSW index)\n        return list(self.storage.items())[:top_k] # Mock result\n\n# 1. Initialize the Archive\ndb = VectorDB()\n\n# 2. Insert the Lost Memory\n# IMPORTANT: The Golem needs to know what it is. Add metadata={'type': 'Epiphany'}\nvector_recuerdo = [0.5, 0.5, 0.5]\n# <--- YOUR CODE: Call db.insert\n\n# 3. Retrieve the most relevant memory\n# <--- YOUR CODE: Call db.query and save to 'resultados'\nresultados = []"
    },
    "solutionCode": "class VectorDB:\n    def __init__(self):\n        self.storage = {}\n    \n    def insert(self, id, vector, metadata):\n        self.storage[id] = {'vec': vector, 'meta': metadata}\n        print(f\"[DB] Insertado {id} con meta: {metadata}\")\n        \n    def query(self, query_vector, top_k=1):\n        # Simulación simple\n        best_id = None\n        best_score = -1\n        for uid, data in self.storage.items():\n            # Producto punto simple como score\n            score = sum(i*j for i,j in zip(query_vector, data['vec']))\n            if score > best_score:\n                best_score = score\n                best_id = uid\n        \n        if best_id:\n            return [(best_id, self.storage[best_id])]\n        return []\n\ndb = VectorDB()\n\n# Inserción con Metadata\nmetadata_vital = {'tipo': 'Epifanía', 'texto': 'Cogito Ergo Sum'}\nvector_recuerdo = [0.5, 0.5, 0.5]\ndb.insert('memoria_core', vector_recuerdo, metadata_vital)\n\n# Búsqueda\nresultados = db.query([0.5, 0.5, 0.5], top_k=1)\nprint(f\"Recuperado: {resultados}\")",
    "validationCode": "\ndef validar_mision(globals_dict):\n    try:\n        if 'db' not in globals_dict:\n            return False, \"¡El Archivo no existe! Inicializa la base de datos 'db'.\"\n        \n        db_inst = globals_dict['db']\n        if not hasattr(db_inst, 'storage') or not db_inst.storage:\n            return False, \"El Archivo está vacío. Debes insertar al menos un recuerdo.\"\n            \n        # Check content\n        found_metadata = False\n        for k, v in db_inst.storage.items():\n            if 'meta' in v and isinstance(v['meta'], dict) and len(v['meta']) > 0:\n                found_metadata = True\n                break\n        \n        if not found_metadata:\n            return False, \"Los recuerdos son inútiles sin contexto. ¡Añade un diccionario de 'metadata' al insertar!\"\n            \n        if 'resultados' not in globals_dict or not globals_dict['resultados']:\n            return False, \"Debes probar el sistema. Ejecuta una `query` y guarda el resultado en la variable 'resultados'.\"\n\n        return True, \"¡Archivado Completo! El Golem ahora tiene una memoria perfecta y organizada.\"\n    except Exception as e:\n        return False, f\"Error en el sistema de archivos: {str(e)}\"\n"
}
{
    "id": "4-1",
    "es": {
        "title": "Herramientas de Poder",
        "lore": "El Golem ha llegado al Sanctum del Equilibrio. Ante él, una Balanza Cósmica espera. En un platillo hay una Piedra Rúnica de peso desconocido. En el otro, debes poner polvo de estrellas equivalente al (Peso de la Piedra * Fase Lunar Actual). El Golem no puede 'adivinar' estos valores; sus datos de entrenamiento son viejos. Pero puede usar 'Artefactos' (Herramientas) si se lo permites.",
        "lesson": "¡Bienvenido al **LIBRO 4: La Voluntad Propia (Agentes)**!\n\nHasta ahora, el Golem solo hablaba. Ahora, va a **ACTUAR**.\nLos LLMs modernos (como GPT-4) tienen **Function Calling**: Pueden decidir llamar a una función de tu código en lugar de responder texto.\n\nTu misión: Definir las herramientas (`tools`) para que el Golem decida usarlas.\n- `obtener_peso(objeto)`\n- `fase_lunar_actual()`",
        "hints": [
            "Paso 2: Comprueba el prompt. Si pide 'equilibrar la Runa_Ignis', el Golem necesita saber su peso.",
            "Retorna un diccionario JSON: `{\"tool\": \"obtener_peso\", \"args\": {\"objeto\": \"Runa_Ignis\"}}`.",
            "Añade un campo 'reasoning' para explicar por qué."
        ],
        "initialCode": "piedra = \"Runa_Ignis\"\n\n# 1. Definimos las Herramientas (Simuladas)\ndef obtener_peso(objeto): \n    return 50 # Kg\ndef fase_lunar_actual(): \n    return 1.5 # Multiplicador de Luna Llena\n\n# Esquema que ve el Golem (Function Definition)\nherramientas = [\n    {\n        \"name\": \"obtener_peso\",\n        \"description\": \"Obtiene el peso exacto de un objeto mágico.\",\n        \"parameters\": {\"type\": \"object\", \"properties\": {\"objeto\": {\"type\": \"string\"}}}\n    },\n    {\n        \"name\": \"fase_lunar_actual\",\n        \"description\": \"Devuelve el multiplicador de magia de la luna actual.\",\n        \"parameters\": {\"type\": \"object\", \"properties\": {}}\n    }\n]\n\nprompt = f\"Calcula el polvo necesario para equilibrar la {piedra}. Fórmula: Peso * FaseLunar.\"\n\n# 2. Simulación del Cerebro del Agente\n# El Golem debe decidir QUÉ herramienta llamar primero.\nclass AgenteGolem:\n    def pensar(self, prompt, herramientas):\n        # <--- TU CÓDIGO AQUÍ: \n        # Devuelve un JSON simulando la decisión del Golem.\n        # Ejemplo: return {\"tool\": \"obtener_peso\", \"args\": {\"objeto\": piedra}}\n        return None\n\nagente = AgenteGolem()\ndecision = agente.pensar(prompt, herramientas)\nprint(f\"El Golem decide usar: {decision}\")"
    },
    "en": {
        "title": "Tools of Power",
        "lore": "The Golem has reached the Sanctum of Balance. Before it, a Cosmic Scale awaits. On one plate lies a Rune Stone of unknown weight. On the other, you must place stardust equivalent to (Stone Weight * Current Moon Phase). The Golem cannot 'guess' these values; its training data is old. But it can use 'Artifacts' (Tools) if you allow it.",
        "lesson": "Welcome to **BOOK 4: Free Will (Agents)**!\n\nUntil now, the Golem only spoke. Now, it will **ACT**.\nModern LLMs (like GPT-4) have **Function Calling**: They can decide to call a function in your code instead of responding with text.\n\nYour mission: Define the tools (`tools`) for the Golem to decide to use them.\n- `obtener_peso(object)`\n- `fase_lunar_actual()`",
        "hints": [
            "Step 2: Check the prompt. If it asks to 'balance the Runa_Ignis', the Golem needs to know its weight.",
            "Return a JSON dictionary: `{\"tool\": \"obtener_peso\", \"args\": {\"objeto\": \"Runa_Ignis\"}}`.",
            "Add a 'reasoning' field to explain why."
        ],
        "initialCode": "piedra = \"Runa_Ignis\"\n\n# 1. Define the Tools (Simulated)\ndef obtener_peso(objeto): \n    return 50 # Kg\ndef fase_lunar_actual(): \n    return 1.5 # Full Moon Multiplier\n\n# Schema seen by the Golem (Function Definition)\nherramientas = [\n    {\n        \"name\": \"obtener_peso\",\n        \"description\": \"Gets the exact weight of a magical object.\",\n        \"parameters\": {\"type\": \"object\", \"properties\": {\"objeto\": {\"type\": \"string\"}}}\n    },\n    {\n        \"name\": \"fase_lunar_actual\",\n        \"description\": \"Returns the magic multiplier of the current moon.\",\n        \"parameters\": {\"type\": \"object\", \"properties\": {}}\n    }\n]\n\nprompt = f\"Calculate the stardust needed to balance the {piedra}. Formula: Weight * MoonPhase.\"\n\n# 2. Agent Brain Simulation\n# The Golem must decide WHICH tool to call first.\nclass AgenteGolem:\n    def pensar(self, prompt, herramientas):\n        # <--- YOUR CODE HERE: \n        # Returns a JSON simulating the Golem's decision.\n        # Example: return {\"tool\": \"obtener_peso\", \"args\": {\"objeto\": piedra}}\n        return None\n\nagente = AgenteGolem()\ndecision = agente.pensar(prompt, herramientas)\nprint(f\"The Golem decides to use: {decision}\")"
    },
    "solutionCode": "piedra = \"Runa_Ignis\"\n\nclass AgenteGolem:\n    def pensar(self, prompt, herramientas):\n        # Simulación: El LLM analiza el prompt y ve que necesita el peso\n        if \"peso\" in prompt.lower() or \"polvo\" in prompt.lower() or \"equilibrar\" in prompt.lower():\n            return {\n                \"tool\": \"obtener_peso\",\n                \"args\": {\"objeto\": piedra},\n                \"reasoning\": \"Necesito saber el peso para aplicar la fórmula.\"\n            }\n        return None\n\nagente = AgenteGolem()\nherramientas = [{\"name\": \"obtener_peso\"}, {\"name\": \"fase_lunar_actual\"}]\n\nprompt = f\"Calcula el polvo necesario para la {piedra}.\"\ndecision = agente.pensar(prompt, herramientas)\n\nif decision:\n    print(f\"[PENSAMIENTO] {decision['reasoning']}\")\n    print(f\"[ACCIÓN] Llamando a herramienta: {decision['tool']} con {decision['args']}\")\nelse:\n    print(f\"[PENSAMIENTO] No sé qué herramienta usar.\")",
    "validationCode": "\ndef validar_mision(globals_dict):\n    try:\n        if 'decision' not in globals_dict:\n            return False, \"El Golem no ha tomado ninguna decisión.\"\n            \n        dec = globals_dict['decision']\n        if not isinstance(dec, dict):\n            return False, \"La decisión debe ser un diccionario (JSON estructurado).\"\n            \n        if dec.get('tool') != 'obtener_peso':\n            return False, \"El primer paso lógico es pesar la piedra. El Golem intentó hacer otra cosa o nada.\"\n            \n        if dec.get('args', {}).get('objeto') != 'Runa_Ignis':\n            return False, \"El Golem quiere pesar el objeto incorrecto.\"\n\n        return True, \"¡Conexión Establecida! El Golem ha decidido usar una Herramienta de Poder.\"\n    except Exception as e:\n        return False, f\"Error en el núcleo del agente: {str(e)}\"\n"
}